<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>FaWave 桌面版</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="FaWave desktop">
<meta name="author" content="fengmk2 <fengmk2@gmail.com>">
<link rel="stylesheet" href="css/index.css" />
<link rel="stylesheet" href="css/emoji.css" />
<link rel="stylesheet" href="themes/pip_io/css/theme.css" />
<style id="styleCustomResize"></style>
<script src="js/lib/jquery-1.8.2.min.js"></script>
<script src="js/lib/jquery.rotate.1-1.js" ></script>
<script src="js/lib/special_scroll.js"></script>
<script src="js/lib/jq.mobi.min.js"></script>
<script src="js/lib/keypress.js"></script>
<script src="js/patch.js"></script>
<script src="index.js"></script>
<script src="js/shortcuts.js"></script>
<script>
var i18n = require('./js/i18n');
var _u = {
  // 向页面写内容
  w: function (s) {
    document.write(s);
  },
  // 向页面写本地化后的内容
  wi: function (s, e) {
    _u.w(i18n.get(s, e));
  },
  wia: function (sel, attr, s, e) {
    jq(sel).attr(attr, i18n.get(s, e));
  },
};
</script>
</head>

<body>
   
<div id="wrapper">
  <div id="submitWarp">
    <div class="w">
    <ul id="accountsForSend"></ul>
    <textarea id="txtContent"></textarea>
    <div class="ctr">
      <span class="wordCount_double">140</span>
      /
      <span class="wordCount">140</span>
      &nbsp;
      <a id="btnAddEmotional" data-target="txtContent">
        <img src="images/face.gif" /><script>_u.wi('comm_emotional')</script>
      </a>
      <script>_u.wia('#btnAddEmotional','title','btn_emotional_title');</script>&nbsp;
      <a id="btnUploadPic" href="javascript:jq('#fileDialog').trigger('click');">
        <img src="images/image.gif" /><script>_u.wi('comm_pic')</script>
      </a>
      <input class="hide" id="fileDialog" type="file" />
      <script>_u.wia('#btnUploadPic','title','btn_pic_title');</script>&nbsp;
      <button id="btnClearText" class="btn"><script>_u.wi('comm_clear')</script></button>
      <!-- <span id="doingWarp"></span> -->
      <span class="hide">
      <a id="urlShortenBtn" href="javascript:;" onclick="addShortenUrl()"><img src="images/link_add.png" /></a>
      <script>_u.wia('#urlShortenBtn','title','comm_url_shorten');</script>
      <input type="text" id="urlShortenInp" />
      </span>
      <input id="btnSend" type="button" class="btn send" disabled="disabled" />
      <script>_u.wia('#btnSend','value','comm_send'); _u.wia('#btnSend','title','comm_send_tip');</script>
    </div>
    </div>
  </div><!-- submitWarp END -->
  <div id="header">
    <span id="loading"><img src="images/loader.gif" /></span>
    <div class="user">
      <a class="face" href="#"><img class="icon" src="images/1.gif" /><img class="bt" src="images/1.gif" /></a>
      <span class="info">
        <a class="name_link user_link" href="#"><span class="name"></span><br/></a>
        <span class="nums"></span>
      </span>
      <span class="top_btns">
        <span class="search_span">
          <a id="btnShowSearch" href="javascript:void(0);" 
            class="search show_search_btn" title="_u.wi('btn_search_title')">
            <img src="images/search.png" /><script>_u.wi('comm_search')</script>
          </a>
          <script>_u.wia('#btnShowSearch','title','btn_search_title');</script>
          <span class="searchWrap">
            <input type="text" class="txtSearch" />
            <a id="btnSearch" href="javascript:void(0);" class="btnSearch">
              <img src="images/search.png" />
            </a>
            <img class="arrow" src="images/layerArrow.gif"/>
            <script>_u.wia('#btnSearch','title','btn_search_title');</script>
          </span>
        </span>
        <span class="user_search_span">
          <a id="btnShowSearchUser" href="javascript:void(0);" 
            class="search search_user show_search_btn" title="_u.wi('btn_search_title')">
            <img src="images/face.gif" /><script>_u.wi('comm_search_user')</script>
          </a>
          <script>_u.wia('#btnShowSearchUser','title','btn_search_user_title');</script>
          <span class="searchWrap searchUserWrap">
            <input type="text" class="txtSearch" />
            <a id="btnSearchUser" href="javascript:" class="btnSearch">
              <img src="images/search.png" />
            </a>
            <img class="arrow" src="images/layerArrow.gif"/>
            <script>_u.wia('#btnSearchUser','title','btn_search_user_title');</script>
          </span>
        </span>
        <a id="btnLongText" href="javascript:void(0);" class="quickUpImg hide" onclick="openLongText();"><img src="images/longtext.png" /><script>_u.wi('comm_longtext')</script></a>
        <script>_u.wia('#btnLongText','title','btn_longtext_title');</script>
        <a id="btnQuickUpImg" href="javascript:void(0);" class="quickUpImg hide" onclick="openUploadImage();"><img src="images/image.gif" /><script>_u.wi('comm_pic')</script></a>
        <script>_u.wia('#btnQuickUpImg','title','btn_pic_title');</script>
      </span>
      <span id="topAd"></span>
      <a id="show_status_input" href="javascript:;" class="write"><script>_u.wi('comm_new_tweet')</script><b></b></a>
    </div>
    <ul id="tl_tabs" class="tabs">
      <span class="btns">
        <a class="hide" id="scs">scs</a>
        <a herf="javascript:;" href="javascript:window.location='options.html';">配置</a>
        <a id="doingWithCapture" class="hide" href="javascript:;"><img src="images/capture.png" /></a>
        <script>_u.wia('#doingWithCapture','title','btn_share_title_with_capture');</script>
        <!--
        <a id="doing" href="javascript:void(0);"><img src="images/world_link.png" /></a>
        <script>_u.wia('#doing','title','btn_share_title');</script>
        -->
        <a id="btnForceRefresh" class="hide" href="javascript:;" onclick="forceRefresh(this)"><img src="images/refresh.png" /></a>
        <script>_u.wia('#btnForceRefresh','title','btn_refresh_title');</script>
        <!-- 
        <a id="btnNewWinPopup" href="javascript:void(0);" onclick="openPopupInNewWin()"><img src="images/new_win.png" /></a> 
        <script>_u.wia('#btnNewWinPopup','title','btn_new_win_title');</script>
        <a id="btnAlertMode" href="javascript:void(0);" mode="alert" onclick="changeAlertMode()">
          <img src="images/alert_mode.png" />
        </a>
        <a id="btnAutoInsert" href="javascript:void(0);" mode="notautoinsert" onclick="changeAutoInsertMode()"><img src="images/notautoinsert.png" /></a>
        -->
      </span>
      <li class="tab-friends_timeline timeline_tab" data-type="friends_timeline" href="#friends_timeline_timeline"><script>_u.wi('comm_TabName_friends_timeline')</script><span class="unreadCount"></span></li>
      <li class="tab-mentions timeline_tab" data-type="mentions" href="#mentions_timeline"><script>_u.wi('comm_TabName_mentions')</script><span class="unreadCount"></span></li>
      <li class="tab-comments_mentions timeline_tab" data-type="comments_mentions" href="#comments_mentions_timeline"><script>_u.wi('comm_TabName_comments_mentions')</script><span class="unreadCount"></span></li>
      <li class="tab-comments_timeline timeline_tab" data-type="comments_timeline" href="#comments_timeline_timeline"><script>_u.wi('comm_TabName_comments_timeline')</script><span class="unreadCount"></span></li>
      <li class="tab-direct_messages_both timeline_tab" data-type="direct_messages_both" href="#direct_messages_both_timeline"><script>_u.wi('comm_TabName_direct_messages')</script><span class="unreadCount"></span></li>
      <li class="tab-favorites only_click timeline_tab" data-type="favorites" href="#favorites_timeline"><script>_u.wi('comm_TabName_favorites')</script><span class="unreadCount"></span></li>
      <li class="tab-followers only_click timeline_tab hide" data-type="followers" href="#followers_timeline"><script>_u.wi('comm_TabName_followers')</script><span class="unreadCount"></span></li>
      <li class="tab-user_timeline only_click timeline_tab" data-type="user_timeline" href="#user_timeline_timeline"><script>_u.wi('comm_TabName_user_timeline')</script><span class="unreadCount"></span></li>
    </ul>
    <div class="clearFix"></div>
  </div>
  <div class="warp">
    <div id='friends_timeline_timeline' class="list_p">
    <div class="list_warp">
      <ul class="list"></ul>
      <div id="friends_timeline_rm_loading" class="readmore_loading"><img src="images/loading_s.gif" /></div>
    </div>
    </div>
    <div id="mentions_timeline" class="list_p" style="display:none;">
    <div class="list_warp">
      <ul class="list"></ul>
      <div id="mentions_rm_loading" class="readmore_loading"><img src="images/loading_s.gif" /></div>
    </div>
    </div>
    <div id="comments_mentions_timeline" class="list_p" style="display:none;">
    <div class="list_warp">
      <ul class="list"></ul>
      <div id="comments_mentions_rm_loading" class="readmore_loading"><img src="images/loading_s.gif" /></div>
    </div>
    </div>
    <div id="comments_timeline_timeline" class="list_p" style="display:none;">
    <div class="list_warp">
      <ul class="list"></ul>
      <div id="comments_timeline_rm_loading" class="readmore_loading"><img src="images/loading_s.gif" /></div>
    </div>
    </div>
    <div id="direct_messages_both_timeline" class="list_p" style="display:none;">
    <div class="list_warp">
        <div style="padding: 2px 0 0 10px;">
            <script>_u.wi('abb_send_direct_message_to_user')</script> @<input type="text" class="txtSearch" id="direct_message_user" />
        </div>
      <ul class="list"></ul>
      <div id="direct_messages_both_rm_loading" class="readmore_loading"><img src="images/loading_s.gif" /></div>
    </div>
    </div>
    <div id='favorites_timeline' class="list_p" style="display:none;">
          <div class="list_warp">
              <ul class="list"></ul>
      <div id="favorites_rm_loading" class="readmore_loading"><img src="images/loading_s.gif" /></div>
          </div>
        </div>
    <div id="followers_timeline" class="list_p" style="display:none;">
    <div class="list_warp">
      <div id="fans_tab" class="tab2">
          <p>
          <span class="tab_friends" t="friends"><font><script>_u.wi('comm_my')</script></font><script>_u.wi('comm_follow')</script></span>
          <span class="active tab_followers" t="followers"><font><script>_u.wi('comm_my')</script></font><script>_u.wi('comm_fans')</script></span>
          </p>
      </div>
      <ul class="list"></ul>
      <div id="followers_rm_loading" class="readmore_loading"><img src="images/loading_s.gif" /></div>
    </div>
    </div>
    <div id="user_timeline_timeline" class="list_p" style="display:none;">
    <div class="list_warp">
      <ul class="list"></ul>
      <div id="user_timeline_rm_loading" class="readmore_loading"><img src="images/loading_s.gif" /></div>
    </div>
    </div>
    
    <div id="accountListDock">
    <ul></ul>
    </div><!-- accountListDock END -->

    <span id="gototop" class="gototop" title="返回顶部"><img src="images/go_to_top.png" /></span>
    <script>_u.wia('#gototop','title','comm_go_to_top');</script>

  </div><!-- div.wrap END -->
  
  <!-- 表情选择 -->
  <div id="face_box" class="layerBox" style="display:none;">
    <div class="layerBoxCon1">
      <div class="faceItem clearFix">
        <div class="layerArrow"></div>
        <div class="face_tab tab2">
          <p>
            <a id="btnFaceBoxClose" class="close"></a>
            <script>_u.wia('#btnFaceBoxClose','title','comm_close');</script>
          </p>
        </div>
        <div class="faceItemPicbg">
        </div>
      </div>
    </div>
  </div>
  <input id="face_box_target_id" type="hidden" value="" />
  <!-- 表情选择 End -->
</div><!-- wrapper END -->

<div id="ye_dialog_window" >
  <a title="关闭 Close" href="javascript:void(0);" class="close_dialog" id="ye_dialog_close"></a>
  <div id="ye_dialog_title"></div>
  <div id="ye_dialog_body" >
    <div class="replyDialog">
      <textarea class="uTextarea" id="replyTextarea"></textarea><br/>
      <span id="replyInputCount" class="conTinge">
        (还可以输入
        <span class="wordCount_double">140</span>
        /
        <span class="wordCount">140</span>
        字)
      </span>
      
      <a id="btnAddReplyEmotional" data-target="replyTextarea">
        <img src="images/face.gif" /><script>_u.wi('comm_emotional')</script>
      </a>
      <script>_u.wia('#btnAddReplyEmotional','title','btn_emotional_title');</script>
      <p>
        <input type="checkbox" id="chk_sendOneMore" />
        <label for="chk_sendOneMore" id="txt_sendOneMore"></label><br/>
        <input type="checkbox" id="chk_sendOneMore2" />
        <label for="chk_sendOneMore2" id="txt_sendOneMore2"></label><br/>
        <input type="checkbox" id="chk_originalComment" />
        <label for="chk_originalComment" id="txt_originalComment">包含原评论</label>
      </p>
      <button id="replySubmit" type="button" title="按 ctrl + enter 发送" class="send btn" style="float: right;"><script>_u.wi('comm_send')</script></button>
      <a href="javascript:void(0);" class="close_dialog" style="float: right; color: #99a8bb; margin-right: 20px; margin-top: 5px; font-size: 10px;"><script>_u.wi('comm_close')</script></a>
      <script>_u.wia('#replySubmit','title','comm_send_tip');</script>
    </div>
  </div>
  <input type="hidden" id="actionType" value="" />
  <input type="hidden" id="replyTweetId" value="" />
  <input type="hidden" id="replyUserName" value="" />
  <input type="hidden" id="replyUserId" value="" />
  <input type="hidden" id="whisperToUserId" value="" />
  <input type="hidden" id="repostTweetId" value="" />
  <input type="hidden" id="commentUserId" value="" />
  <input type="hidden" id="commentTweetId" value="" />
  <input type="hidden" id="commentCommentId" value="" /><!-- 回复的评论ID -->
</div>

<div id="msgInfoWarp"></div>

<!-- 上传图片预览 -->
<div id="upImgPreview" class="upload_image_preview">
  <img class="arrow" src="images/layerArrow.gif" />
  <a class="close" href="javascript:window.imgForUpload = null; $('#upImgPreview').hide(); $('#txtContent').focus();" title="Close"></a>
  <div class="img"></div>
  <div class="loading_bar"><div><span></span></div></div>
</div>
<div id="upImgPreview_reply" class="upload_image_preview">
  <img class="arrow" src="images/layerArrow.gif" />
  <a class="close" 
    href="javascript:window.imgForUpload_reply = null; $('#upImgPreview_reply').hide(); countReplyText();"
    title="Close"></a>
  <div class="img"></div>
  <div class="loading_bar"><div><span></span></div></div>
</div>

<!-- 模板选择 -->
<script id="tp_time_line" type="text/template">

<li class="tweetItem showCounts_#{tweet.id} <?js if (!tweet.readed) { ?>unread-item<?js } ?> <?js if (tweet.myTweet) { ?>myTweet<?js } ?> " id="tweet#{tweet.id}"
  data-id="#{tweet.id}" data-timestamp="#{tweet.timestamp || ''}"
  data-uid="#{tweet.user.id}" data-screen_name="#{tweet.user.screen_name}">

  <div class="li_wrap clearFix #{tweet.is_me ? 'li_wrap_is_me' : ''}">
  <div class="usericon">
    <span class="showtip">
    <a class="user_head user_link" data-uid="#{user.id}"
      rhref="#{user.t_url}">
      <img src="#{ user.profile_image_url }" />
    </a>
    #{buildTipboxUserInfo(user, show_fullname)}
    </span>
  </div>
  <div class="mainContent commentWrap">
    <span class="arrow_r"></span>
    <div class="userName">
      <a class="user_link" data-uid="#{user.id}" rhref="#{user.t_url}" title="#{getUserCountsInfo(user)}">
        #{user.screen_name}<?js if (user.verified) { ?><img title="#{_u.i18n('comm_verified')}" 
        src="images/verified#{user.verified_type && user.verified_type > 0 ? '_blue.png' : '.gif'}" /><?js } ?>
      </a>
      <?js if (show_fullname) { ?><span class="fullname">#{user.name}</span> <?js } ?>
      <span class="edit">
        <?js if (tweet.related_dialogue_url) { ?>
        <a href="#{tweet.related_dialogue_url}" title="#{_u.i18n('comm_show_related_dialogue')}" target="_blank"><img src="images/inreply.png" /></a>
        <?js } ?>
        <?js if (support_instapaper) { ?>
        <a href="javascript:void(0);" onclick="javascript:read_later(this, 'instapaper');" title="#{_u.i18n('btn_read_later_title')}">RL</a>
        <?js } ?>
        <?js if (support_readitlater) { ?>
        <a href="javascript:void(0);" onclick="javascript:read_later(this, 'readitlater');" title="#{_u.i18n('btn_read_it_later_title')}">RIL</a>
        <?js } ?>
        #{ btn.addFavoritesMsgBtn + btn.delFavoritesMsgBtn + (tweet.favorite_count ? '<span class="commentCounts">(' + tweet.favorite_count + ')</span>' : '') + btn.replyBtn + btn.retweetBtn + btn.oretweetBtn + btn.repostBtn + btn.repostCounts + btn.commentBtn + btn.commentCounts + btn.new_msgBtn + btn.delTweetBtn + btn.delCommentBtn + btn.delDirectMsgBtn }
        <a href="javascript:void(0);" class="hide" title="#{_u.i18n('btn_translate_title')}">#{_u.i18n("btn_translate")}</a>
      </span>
    </div>
    <div class="msg">
      <div class="tweet">
        <div class="tweet_text">
          #{processMsg(account, tweet)} #{btn.showMapBtn}
          <?js if (tweet.crosspostSource) { ?>
          <a target="_blank" href="#{tweet.crosspostSource}" title="#{_u.i18n('comm_show_original')}">#{_u.i18n('comm_show_original')}</a>
          <?js } ?>
        </div>

        <?js 
        if (tweet.thumbnail_pic) { ?>
        <div>
        <?js
          var pics = [];
          if (!Array.isArray(tweet.thumbnail_pic)) {
            pics = [[tweet.thumbnail_pic, tweet.bmiddle_pic, tweet.original_pic]];
          } else {
            for (var i = 0; i < tweet.thumbnail_pic.length; i++) {
              pics.push([tweet.thumbnail_pic[i], tweet.bmiddle_pic[i], tweet.original_pic[i]]);
            }
          }
          for (var i = 0; i < pics.length; i++) {
            var pic = pics[i];
        ?>
          <a target="_blank" href="javascript:void(0);" bmiddle="#{pic[1]}" 
            original="#{pic[2]}" title="#{_u.i18n("btn_show_original_pic_title")}" 
            class="thumbnail_pic" >
            <img class="imgicon pic" src="#{pic[0]}" />
          </a>
        <?js } ?>
        </div>
        <?js } ?>

        <?js if (tweet.retweet_me || tweet.retweet_user) { ?>
        <div class="retweet_info">#{_u.i18n("comm_retweet_by_before")} <?js if(tweet.retweet_me){ ?>
          <a target="_blank" data-uid="#{tweet.retweet_me.id}" class="user_link"
            rhref="#{tweet.retweet_me.t_url}">
            #{tweet.retweet_me.screen_name}<?js if (tweet.retweet_me.verified) { ?><img title="#{_u.i18n('comm_verified')}" src="images/verified#{tweet.retweet_me.verified_type && tweet.retweet_me.verified_type > 0 ? '_blue.png' : '.gif'}" /><?js } ?>
          </a>
          <?js if (show_fullname) { ?><span class="fullname">#{tweet.retweet_me.name}</span> <?js } ?>
        <?js } ?>
           <?js if (tweet.retweet_user) { ?>
            <?js if (tweet.retweet_me) { ?>、<?js } ?>
            <a target="_blank" data-uid="#{tweet.retweet_user.id}" class="user_link"
              rhref="#{tweet.retweet_user.t_url}">
            #{tweet.retweet_user.screen_name}<?js if (tweet.retweet_user.verified) { ?><img title="#{_u.i18n('comm_verified')}" src="images/verified#{tweet.retweet_user.verified_type && tweet.retweet_user.verified_type > 0 ? '_blue.png' : '.gif'}" /><?js } ?>
          </a>
          <?js if (show_fullname) { ?><span class="fullname">#{tweet.retweet_user.name}</span> <?js } ?>
         <?js } ?> #{_u.i18n("comm_retweet_by_after")}</div>
         <?js } ?>
        </div>
      <?js if (tweet.retweeted_status && tweet.retweeted_status.text) { ?>
      <!-- 转发 -->
      <!-- {{retweeted_status_in}} -->
      <!-- 转发 End -->
      <?js } ?>
    </div>
    <div class="comments" data-id="#{tweet.id}">
      <p class="text_right">
        <a href="javascript:void(0);" class="comment_hide_list_btn">隐藏列表</a>
      </p>
      <ul class="comment_list">

      </ul>
      <div class="comment_paging">
        <a class="pre_page" href="javascript:void(0);">#{_u.i18n("btn_prev_page")}</a>
        <a class="next_page" href="javascript:void(0);">#{_u.i18n("btn_next_page")}</a>
      </div>
      <br />
    </div>
    <?js if (tweet.created_at) { ?>
    <div class="msgInfo">
       <?js if (tweet.t_url) { ?>
       <a data-href="#{tweet.t_url}">#{tweet.created_at.format("yyyy-MM-dd hh:mm:ss")}</a> 
       <?js } else { ?>
       #{tweet.created_at.format("yyyy-MM-dd hh:mm:ss")}
       <?js } ?>
       #{_u.i18n('comm_post_by')} #{(tweet.source || _u.i18n("comm_web_site")).replace('href=', 'data-href=')}
       <?js if (!tweet.retweeted_status && tweet.in_reply_to_status_id && tweet.in_reply_to_screen_name) { ?>
       <a href="javascript:void(0);" class="show_source_status_btn" status_id="#{tweet.in_reply_to_status_id}" 
           title="#{_u.i18n('comm_show_original_status')}">#{_u.i18n("btn_show_source_status", [tweet.in_reply_to_screen_name])}</a>
       <?js } ?>
       <!-- 提示私信是回复给谁的 -->
       #{btn.messageReplyToBtn}
    <?js } ?>
    <!-- 收藏时间 -->
    <?js if (tweet.favorited_at) { ?>
      | 收藏于 #{tweet.favorited_at.format("yyyy-MM-dd hh:mm:ss")}
    <?js } ?>
    </div>
  </div>
  </div> <!-- end .li_wrap -->
  <?js if (tweet.retweeted_status && tweet.retweeted_status.text) { ?>
  <!-- 转发 -->
  <!-- {{retweeted_status_out}} -->
  <!-- {{retweeted_retweeted_status_out}} -->
  <!-- 转发 End -->
  <?js } ?>
</li>
</script>

<!-- 转发模板（包括评论、@我的所带的原status） -->
<!-- 转发 -->
<script id="tp_time_line_rt" type="text/template">

<div class="msg">
  <div class="tweetItem retweeted commentWrap showCounts_#{tweet.retweeted_status.id} <?js if (is_rt_rt){ ?>rt_retweeted<?js } ?>" id="tweet#{tweet.retweeted_status.id}"
    data-id="#{tweet.retweeted_status.id}" data-timestamp="#{tweet.retweeted_status.timestamp || ''}">

    <div class="userName">
      <?js if (is_rt_rt) { ?>
      <span class="showtip">
        <a class="user_link" data-uid="#{tweet.user.id}">
          @#{tweet.user.screen_name}
        </a>
        <?js if (show_fullname) { ?><span class="fullname">#{tweet.user.name}</span> <?js } ?>
        #{buildTipboxUserInfo(tweet.user, show_fullname)}
      </span>
      <?js } ?>
      <?js if ((tType === 'comments_timeline' || tType === 'comments_mentions') && !is_rt_rt) { ?> 
        #{_u.i18n('comm_comment_to_before')} 
      <?js } else { ?> 
        #{_u.i18n('comm_repost_to_before')}
      <?js } ?>
      <span class="showtip">
        <a target="_blank" data-uid="#{tweet.retweeted_status.user.id}" class="user_link"
          rhref="#{tweet.retweeted_status.user.t_url}">
          @#{tweet.retweeted_status.user.screen_name}<?js if(tweet.retweeted_status.user.verified){ ?><img title="#{_u.i18n('comm_verified')}" src="images/verified#{tweet.retweeted_status.user.verified_type && tweet.retweeted_status.user.verified_type > 0 ? '_blue.png' : '.gif'}" /><?js } ?>
        </a>
        <?js if (show_fullname) { ?><span class="fullname">#{tweet.retweeted_status.user.name}</span> <?js } ?>
        #{buildTipboxUserInfo(tweet.retweeted_status.user, show_fullname)}
      </span>
      #{_u.i18n("comm_repost_to_after")}: 
      <span class="edit">
      <?js if (support_instapaper) { ?>
        <a href="javascript:void(0);" onclick="javascript:read_later(this, 'instapaper');" title="#{_u.i18n('btn_read_later_title')}">RL</a>
        <?js } ?>
        <?js if (support_readitlater) { ?>
        <a href="javascript:void(0);" onclick="javascript:read_later(this, 'readitlater');" title="#{_u.i18n('btn_read_it_later_title')}">RIL</a>
      <?js } ?>
        #{ btn.rtAddFavoritesMsgBtn + btn.rtReplyBtn + btn.rtRetweetBtn + btn.rtRepostBtn + btn.rtRepostCounts + btn.rtOretweetBtn + btn.rtCommentBtn + btn.rtCommentCounts }
        <a href="javascript:void(0);" class="hide" title="#{_u.i18n('btn_translate_title')}">#{_u.i18n("btn_translate")}</a>
      </span>
    </div>

    <div class="tweet_text">#{processMsg(account, tweet.retweeted_status)} #{btn.rtShowMapBtn}
    <?js if (tweet.crosspostSource) { ?>
      <a target="_blank" href="#{tweet.crosspostSource}" 
        title="#{_u.i18n('comm_show_original')}">#{_u.i18n('comm_show_original')}</a>
    <?js } ?>
    </div>
    <?js if (tweet.retweeted_status.thumbnail_pic) { ?>
    <div>
      <a target="_blank" href="javascript:void(0);" 
        bmiddle="#{tweet.retweeted_status.bmiddle_pic}" 
        title="#{_u.i18n("btn_show_original_pic_title")}" 
        original="#{tweet.retweeted_status.original_pic}" 
        class="thumbnail_pic" >
      <img class="imgicon pic" src="#{tweet.retweeted_status.thumbnail_pic}" /></a>
    </div>
    <?js } ?>

    <!-- {{retweeted_retweeted_status_in}} -->
    <?js if (tweet.retweeted_status.created_at) { ?>
    <div class="msgInfo">
      <?js if (tweet.retweeted_status.t_url) { ?>
      <a data-href="#{tweet.retweeted_status.t_url}">#{tweet.retweeted_status.created_at.format("yyyy-MM-dd hh:mm:ss")}</a>
      <?js } else { ?>
      #{tweet.retweeted_status.created_at.format("yyyy-MM-dd hh:mm:ss")}
      <?js } ?>
      #{_u.i18n('comm_post_by')} #{(tweet.retweeted_status.source || _u.i18n("comm_web_site")).replace('href=', 'data-href=')}
      <?js if (!tweet.retweeted_status.retweeted_status &&
               tweet.retweeted_status.in_reply_to_status_id &&
               tweet.retweeted_status.in_reply_to_screen_name) { ?>
       <a href="javascript:void(0);" class="show_source_status_btn" 
         status_id="#{tweet.retweeted_status.in_reply_to_status_id}" 
         title="#{_u.i18n('comm_show_original_status')}">
         #{_u.i18n("btn_show_source_status", [tweet.retweeted_status.in_reply_to_screen_name])}</a>
       <?js } ?>
    </div>
    <?js } ?>

    <div class="comments" data-id="#{tweet.retweeted_status.id}">
      <p class="text_right"><a href="javascript:void(0);" class="comment_hide_list_btn">隐藏列表</a></p>
      <ul class="comment_list"></ul>
      <div class="comment_paging">
        <a class="pre_page" href="javascript:void(0);">#{_u.i18n("btn_prev_page")}</a>
        <a class="next_page" href="javascript:void(0);">#{_u.i18n("btn_next_page")}</a>
      </div>
      <br />

    </div>

  </div>

</div>

</script>
<!-- 转发 End -->

<!-- 用户信息tipbox模板 -->
<script id="tp_tipbox_user_info" type="text/template">

<div class="tipbox">
  <div>
    <div class="user_head"><img src="#{user.profile_image_url}" /></div>
    <div class="user_info">
      <p><a class="user_link" data-uid="#{user.id}" 
        rhref="#{user.t_url}">#{user.screen_name}
        <?js if(user.verified){ ?><img title="#{_u.i18n('comm_verified')}" 
        src="images/verified#{user.verified_type && user.verified_type > 0 ? '_blue.png' : '.gif'}" /><?js } ?>
      </a>
      <?js if(show_fullname) { ?><span class="fullname">#{user.name}</span> <?js } ?>
      </p>
      <p>
        <img class="small_icon sicon_gender_#{user.gender}" src="images/transparent.gif" 
          title="<?js if(user.gender == 'm'){ ?> #{_u.i18n('comm_man')} <?js }else if(user.gender == 'f'){ ?> #{_u.i18n('comm_female')} <?js }else{ ?> #{_u.i18n('comm_gender_unknow')} <?js } ?>" />
         <?js if(user.province){ ?>
         #{provinces[user.province] ? provinces[user.province].name : user.province}, #{provinces[user.province] ? provinces[user.province]["citys"][user.city]:user.city}
         <?js } ?>
      </p>
      <p>#{_u.i18n("comm_follow")}: <span><a href="javascript:showFollowers('friends', '#{user.screen_name}', '#{user.id}');">#{user.friends_count == undefined ? _u.i18n("comm_view"): user.friends_count}</a></span>
      &nbsp;&nbsp;&nbsp;&nbsp;#{_u.i18n("comm_fans")}: <span><a href="javascript:showFollowers('followers', '#{user.screen_name}', '#{user.id}');">#{user.followers_count == undefined ? _u.i18n("comm_view"): user.followers_count}</a></span>
      <?js if (user.bi_followers_count !== undefined) { ?>
      &nbsp;&nbsp;&nbsp;&nbsp;#{_u.i18n("comm_bi_follower")}: <span>#{user.bi_followers_count}</span>
      <?js } ?>
      </p>
      <p>#{_u.i18n("comm_tweet")}:
        <span><a href="javascript:void(0);" class="user_link" data-uid="#{user.id}">#{user.statuses_count == undefined ? _u.i18n("comm_view"): user.statuses_count}</a></span>
      <?js if (user.favourites_count !== undefined) { ?>
      &nbsp;&nbsp;&nbsp;#{_u.i18n("comm_favourite")}: <span>#{user.favourites_count}</span>
      <?js } ?>
      </p>
    </div>
  </div>
  <div class="des">
  <?js if (user.verified_reason) { ?>
  #{_u.i18n("comm_verified_reason")}：#{user.verified_reason}<br/>
  <?js } ?>
  <?js if (user.email) { ?>
  #{_u.i18n("comm_email")}: <a href="mailto:${user.email}">${user.email}</a><br/>
  <?js } ?>
  <?js if (user.homepage) { ?>
  #{_u.i18n("comm_homepage")}: <a href="${user.homepage}">${user.homepage}</a><br/>
  <?js } ?>
  <?js if (user.birthday) { ?>
  #{_u.i18n("comm_birthday")}: ${user.birthday}<br/>
  <?js } ?>
  <?js if (user.description) { ?>
  #{_u.i18n("comm_description")}: ${user.description}<br/>
  <?js } ?>
  <?js if (user.jobs && user.jobs.length > 0) { ?>
  #{_u.i18n("comm_jobs")}: ${user.jobs.join(', ')}<br/>
  <?js } ?>
  </div>
</div>
</script>
<!-- 用户信息tipbox模板 END -->

<!-- 用户信息模板(user_timeline) -->
<script id="tp_user_info" type="text/template">

<div class="userinfo_detail">
  <div class="user_head"><img src="#{user.profile_image_url}" /></div>
  <div class="user_info">
    <div class="userName">
      <a data-href="#{user.t_url}">#{user.screen_name}<?js if (user.verified) { ?><img title="#{_u.i18n('comm_verified')}" 
        src="images/verified#{user.verified_type && user.verified_type > 0 ? '_blue.png' : '.gif'}" /><?js } ?></a>
    <?js if (show_fullname) { ?><span class="fullname">#{user.name}</span> <?js } ?>
    <?js if (!user.is_me) { ?>
      <a class="follow" 
        onclick="doReply(this, '#{user.screen_name}', '', '#{user.id}')">@#{user.gender === 'f' ? '她' : '他'}</a>
      <a class="follow" onclick="doNewMessage(this, '#{user.screen_name}','#{user.id}')">#{_u.i18n("abb_direct_message")}</a>
      <?js if (support_blocking) { ?>
      <a class="follow" title='#{_u.i18n("destroy_blocking_title")}' 
        style="#{user.blocking ? '' : 'display:none'}"
        onclick="destroy_blocking(this, '#{user.id}');">#{_u.i18n("destroy_blocking")}</a>
      <a class="follow" title='#{_u.i18n("create_blocking_title")}' 
        style="#{user.blocking ? 'display:none' : ''}"
        onclick="create_blocking(this, '#{user.id}');">#{_u.i18n("create_blocking")}</a>
      <?js } ?>
      <?js if (support_follow) { ?>
      <a class="follow unfollow_btn #{user.following ? '' : 'hide'}" 
         data-uid="#{user.id}" data-screen_name="#{user.screen_name}">#{_u.i18n("comm_f_destroy")}</a>
      <a class="follow follow_btn #{user.following ? 'hide' : ''}" 
        data-uid="#{user.id}" data-screen_name="#{user.screen_name}"><span class="plus">+</span>#{_u.i18n("comm_f_create")}</a>
      <?js if (user.following) { ?>
      <span class="followed">
        <?js if (user.follow_me) { ?>
        #{_u.i18n("comm_f_followed_by_and_following")}
        <?js } else { ?>
        #{_u.i18n("comm_f_followed_by")}
        <?js } ?>
      </span>
      <?js } else if (user.follow_me) { ?>
      <span class="followed">#{_u.i18n("comm_f_following")}</span>
      <?js } ?>
    <?js } ?>
    <?js } else if (support_blocking) { ?>
    <a class="follow" title='#{_u.i18n("showblocking_title")}' 
      onclick="showblocking(false);">#{_u.i18n("showblocking")}</a>
    <?js } ?>
    </div>
    <p>
    <img class="small_icon sicon_gender_#{user.gender}" src="images/transparent.gif" 
      title="<?js if(user.gender == 'm'){ ?> #{_u.i18n('comm_man')} <?js }else if(user.gender == 'f'){ ?> #{_u.i18n('comm_female')} <?js }else{ ?> #{_u.i18n('comm_gender_unknow')} <?js } ?>" />
          <?js if(user.province){ ?>
                  #{provinces[user.province] ? provinces[user.province].name : user.province}, 
                  #{provinces[user.province] ? provinces[user.province]["citys"][user.city] : user.city}
                  <?js } ?>
            </p>
    <p>#{_u.i18n("comm_follow")}: <span><a href="javascript:showFollowers('friends', '#{user.screen_name}', '#{user.id}');">#{user.friends_count == undefined ? _u.i18n("comm_view"): user.friends_count}</a></span>
    &nbsp;&nbsp;#{_u.i18n("comm_fans")}: <span><a href="javascript:showFollowers('followers', '#{user.screen_name}', '#{user.id}');">#{user.followers_count == undefined ? _u.i18n("comm_view"): user.followers_count}</a></span>
    &nbsp;&nbsp;#{_u.i18n("comm_tweet")}:
      <span><a href="javascript:void(0);" class="user_link" data-uid="#{user.id}">#{user.statuses_count == undefined ? _u.i18n("comm_view"): user.statuses_count}</a></span>

    <?js if (user.bi_followers_count !== undefined) { ?>
    &nbsp;&nbsp;#{_u.i18n("comm_bi_follower")}: <span>#{user.bi_followers_count}</span>
    <?js } ?>

    <?js if(user.favourites_count != undefined) { ?>
    &nbsp;&nbsp;#{_u.i18n("comm_favourite")}: <span>#{user.favourites_count}</span>
    <?js } ?>
    </p>
    <?js if (user.url) { ?>
    <p>#{_u.i18n("comm_blog")}: <a data-href="#{user.url}">#{user.url}</a></p>
    <?js } ?>
  </div>
  <div class="des">
  <?js if (user.verified_reason) { ?>
  #{_u.i18n("comm_verified_reason")}：#{user.verified_reason}<br/>
  <?js } ?>
  <?js if (user.email) { ?>
  #{_u.i18n("comm_email")}: <a data-href="mailto:${user.email}">${user.email}</a><br/>
  <?js } ?>
  <?js if (user.homepage) { ?>
  #{_u.i18n("comm_homepage")}: <a data-href="${user.homepage}">${user.homepage}</a><br/>
  <?js } ?>
  <?js if (user.birthday) { ?>
  #{_u.i18n("comm_birthday")}: ${user.birthday}<br/>
  <?js } ?>
  <?js if (user.description) { ?>
  #{_u.i18n("comm_description")}: ${user.description}<br/>
  <?js } ?>
  <?js if (user.jobs && user.jobs.length > 0) { ?>
  #{_u.i18n("comm_jobs")}: ${user.jobs.join(', ')}<br/>
  <?js } ?>
  </div>
  <?js if (user.tags) { ?>
    <div class="tags">#{_u.i18n("comm_tags")}: 
      <?js for(var i=0;i<user.tags.length;i++){ var tag = user.tags[i]; ?>
      <a data-href="#{tag.url}">${tag.name}</a>
      <?js } ?>
    </div>
  <?js } ?>
</div>

</script>

<!-- 粉丝模板 -->
<script id="tp_fans" type="text/template">

<div class="fans">
  <div class="user_head"><img src="#{user.profile_image_url}" /></div>
  <div class="user_info" did="#{user.id}">
    <div class="userName"><a data-uid="#{user.id}" class="user_link"
        rhref="#{user.t_url}">#{user.screen_name}<?js if(user.verified){ ?><img 
        title="#{_u.i18n('comm_verified')}" 
        src="images/verified#{user.verified_type && user.verified_type > 0 ? '_blue.png' : '.gif'}" /><?js } ?></a>
      <a class="follow" onclick="doReply(this, '#{user.screen_name}', '', '#{user.id}')">@</a>
      <a class="follow" onclick="doNewMessage(this, '#{user.screen_name}','#{user.id}')">#{_u.i18n("abb_direct_message")}</a>
    <?js if(support_blocking) { ?>
      <a class="follow" title='#{_u.i18n("destroy_blocking_title")}' 
         style="#{user.blocking ? '' : 'display:none'}"
         onclick="destroy_blocking(this, '#{user.id}');">#{_u.i18n("destroy_blocking")}</a>
      <a class="follow" title='#{_u.i18n("create_blocking_title")}' 
         style="#{user.blocking ? 'display:none' : ''}"
         onclick="create_blocking(this, '#{user.id}');">#{_u.i18n("create_blocking")}</a>
    <?js } ?>
    <?js if (support_follow) { ?>
        <?js if (user.unfollow && user.followed_by !== true) { ?>
            <a class="follow follow_button_destroy" style="display:none;" onclick="f_destroy('#{user.id}', this, '#{user.screen_name}')">#{_u.i18n("comm_f_destroy")}</a>
            <a class="follow follow_button_create" onclick="f_create('#{user.id}', this, '#{user.screen_name}')"><span class="plus">+</span>#{_u.i18n("comm_f_create")}</a>
        <?js } else { ?>
            <a class="follow follow_button_destroy" <?js if(user.followed_by !== true && tType !== 'friends') { ?>style="display:none;"<?js } ?> href="javascript:;" onclick="f_destroy('#{user.id}', this, '#{user.screen_name}')">#{_u.i18n("comm_f_destroy")}</a>
            <a class="follow follow_button_create" <?js if(user.followed_by === true || tType === 'friends') { ?>style="display:none;"<?js } ?> href="javascript:;" onclick="f_create('#{user.id}', this, '#{user.screen_name}')"><span class="plus">+</span>#{_u.i18n("comm_f_create")}</a>
            <?js if((user.followed_by === true || tType === 'friends') && user.following === true) { ?>
                <span class="followed">
                #{_u.i18n("comm_f_followed_by_and_following")}
                </span>
            <?js } ?>
        <?js } ?>
      <?js } ?> 
    </div>
    <p>
       <img class="small_icon sicon_gender_#{user.gender}" src="images/transparent.gif" 
        title="<?js if(user.gender == 'm'){ ?> #{_u.i18n('comm_man')} <?js }else if(user.gender == 'f'){ ?> #{_u.i18n('comm_female')} <?js }else{ ?> #{_u.i18n('comm_gender_unknow')} <?js } ?>" />
     <?js if(user.province){ ?>
          #{provinces[user.province] ? provinces[user.province].name : user.province}, 
          #{provinces[user.province] ? provinces[user.province]["citys"][user.city] : user.city}
     <?js } else if(user.location){ ?>
      #{user.location}
     <?js } ?>
    </p>
    <p>#{_u.i18n("comm_follow")}: <span><a href="javascript:showFollowers('friends', '#{user.screen_name}', '#{user.id}');">#{user.friends_count == undefined ? _u.i18n("comm_view"): user.friends_count}</a></span>
       &nbsp;&nbsp;#{_u.i18n("comm_fans")}: <span><a href="javascript:showFollowers('followers', '#{user.screen_name}', '#{user.id}');">#{user.followers_count == undefined ? _u.i18n("comm_view"): user.followers_count}</a></span>
       &nbsp;&nbsp;#{_u.i18n("comm_tweet")}:
        <span><a class="user_link" data-uid="#{user.id}">#{user.statuses_count == undefined ? _u.i18n("comm_view"): user.statuses_count}</a></span>
      <?js if (user.bi_followers_count !== undefined) { ?>
      &nbsp;&nbsp;#{_u.i18n("comm_bi_follower")}: <span>#{user.bi_followers_count}</span>
      <?js } ?>
      <?js if(user.favourites_count != undefined) { ?>
      &nbsp;&nbsp;#{_u.i18n("comm_favourite")}: <span>#{user.favourites_count}</span>
      <?js } ?>
    </p>
    <?js if (user.url) { ?>
    <p>#{_u.i18n("comm_blog")}：<a data-href="#{user.url}">#{user.url}</a></p>
    <?js } ?>
  </div>
  <div class="des">
  <?js if (user.verified_reason) { ?>
  #{_u.i18n("comm_verified_reason")}：#{user.verified_reason}<br/>
  <?js } ?>
  <?js if (user.email) { ?>
  #{_u.i18n("comm_email")}: <a data-href="mailto:${user.email}">${user.email}</a><br/>
  <?js } ?>
  <?js if (user.homepage) { ?>
  #{_u.i18n("comm_homepage")}: <a data-href="${user.homepage}">${user.homepage}</a><br/>
  <?js } ?>
  <?js if (user.birthday) { ?>
  #{_u.i18n("comm_birthday")}: ${user.birthday}<br/>
  <?js } ?>
  <?js if (user.description) { ?>
  #{_u.i18n("comm_description")}: ${user.description}<br/>
  <?js } ?>
  <?js if (user.jobs && user.jobs.length > 0) { ?>
  #{_u.i18n("comm_jobs")}: ${user.jobs.join(', ')}<br/>
  <?js } ?>
  </div>
  <?js if (user.tags) { ?>
  <div class="tags">#{_u.i18n("comm_tags")}: 
    <?js for(var i=0;i<user.tags.length;i++){ var tag = user.tags[i]; ?>
    <a data-href="http://t.qq.com/search/tag.php?k=#{tag.name}">#{tag.name}</a>
    <?js } ?>
  </div>
  <?js } ?>
  <?js if (user.status && user.status.text) { ?>
  <br/>
  <div class="recent_tweet">#{_u.i18n("comm_recent_tweet")}: 
  ${user.status.text}
  |
  <?js if (user.status.t_url) { ?>
  <a data-href="#{user.status.t_url}">#{user.status.created_at.format("yyyy-MM-dd hh:mm:ss")}</a>
  <?js } else { ?>
  #{user.status.created_at.format("yyyy-MM-dd hh:mm:ss")}
  <?js } ?>
  #{_u.i18n('comm_post_by')} #{user.status.source || _u.i18n("comm_web_site")}
  </div>
  <?js } ?>
</div>

</script>

<script id="comment_item" type="text/template">
<dl class="comment_item" id="comment_#{item.id}">
  <dt>
    <a class="user_link" data-uid="#{item.user.id}" rhref="#{item.user.t_url}">
      <img class="small_head" src="#{item.user.profile_image_url}" alt="#{item.user.screen_name}" />
    </a>
  </dt>
  <dd>
    <a class="user_link" data-uid="#{item.user.id}" rhref="#{item.user.t_url}">@${item.user.screen_name}</a>#{verified}：
    <span class="text">#{text}</span>
    <?js if (isComment) { ?>
    <span class="date">(#{created_at} #{_u.i18n("comm_post_by")} 
      #{(item.source || _u.i18n("comm_web_site")).replace('href=', 'data-href=')})</span>
    <?js } else { ?>
    <span class="date">(<a data-href="#{item.t_url}">#{created_at}</a> 
      #{_u.i18n("comm_post_by")} 
      #{(item.source || _u.i18n("comm_web_site")).replace('href=', 'data-href=')} #{_u.i18n("comm_repost")})</span>
    <?js } ?>
    <div class="info">
      <?js if (isComment) { ?>
      <a class="commenttweet" 
        data-id="#{item.status.id}" data-uid="#{item.status.user.id}" data-screen_name="${item.status.user.screen_name}" 
        data-cid="#{item.id}" data-cuid="#{item.user.id}" data-csn="${item.user.screen_name}"
        title="#{_u.i18n('btn_reply_comment_title')}">#{_u.i18n("comm_reply")}</a>
      <?js } else { ?>
      <a class="reposttweet" data-id="#{item.id}" data-uid="#{item.user.id}" data-screen_name="${item.user.screen_name}" 
        title="#{_u.i18n('btn_repost_title')}">#{_u.i18n("comm_repost")}</a>
      <i>|</i>
      <a class="commenttweet" data-id="#{item.id}" data-uid="#{item.user.id}" data-screen_name="${item.user.screen_name}"
        title="#{_u.i18n('btn_comment_title')}">#{_u.i18n("comm_comment")}</a>
      <?js } ?>
    </div>
  </dd>
</dl>
</script>

<script>
var TEMPLATE = $("#tp_time_line").html();
var TEMPLATE_RT = $("#tp_time_line_rt").html();
var TEMPLATE_USER_INFO = $("#tp_user_info").html();
var TEMPLATE_TIPBOX_USER_INFO = $("#tp_tipbox_user_info").html();
var TEMPLATE_FANS = $("#tp_fans").html();
var TEMPLATE_COMMENT_ITEM = $('#comment_item').html();
</script>

<script>

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-35349616-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>


